<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Reconciliation ‚Äì Agile AI University</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Reuse canonical admin styles -->
  <link rel="stylesheet" href="/admin.css" />

  <!-- Firebase SDKs (same pattern as admin) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

  <script src="/admin.js" defer></script>
  <script src="/reconciliation.js" defer></script>
</head>

<body>
  <header class="admin-header">
    <div class="admin-header-left">
      <strong>Agile AI University ‚Äì Admin</strong>
    </div>
    <div class="admin-header-right">
      <span id="admin-user"></span>
      <button id="logoutBtn">Logout</button>
    </div>
  </header>

  <div class="admin-container">
    <aside class="admin-sidebar">
      <nav>
        <a href="/index.html">Dashboard</a>
        <a href="/batch.html">Batch Management</a>
        <a href="/issuance.html">Credential Issuance</a>
        <a href="/csv.html">CSV Import</a>
        <a href="/verifications.html">Verification Requests</a>
        <a href="/audit.html">Audit Logs</a>

        <a href="/reconciliation.html" class="active">Reconciliation</a>
      </nav>
    </aside>

    <main class="admin-main" id="reconciliation">
      <h1>Reconciliation</h1>
      <p class="muted">
        Read-only financial and entitlement reconciliation.
        All records are system-generated and audit-safe.
      </p>

      <!-- =====================================================
           üîπ PHASE 1 ‚Äî SUMMARY PANEL (READ-ONLY)
           ===================================================== -->
      <section class="recon-summary">
        <div class="recon-summary-grid">
          <div>
            <strong>Date Range</strong>
            <div id="summary-date-range" class="muted">‚Äî</div>
          </div>
          <div>
            <strong>Total Transactions</strong>
            <div id="summary-total-count">‚Äî</div>
          </div>
          <div>
            <strong>Total Amount</strong>
            <div id="summary-total-amount">‚Äî</div>
          </div>
          <div>
            <strong>Failed / Refunded</strong>
            <div id="summary-failed-amount">‚Äî</div>
          </div>
          <div>
            <strong>Currency</strong>
            <div id="summary-currency">‚Äî</div>
          </div>
          <div>
            <strong>Data Source</strong>
            <div class="muted">Razorpay Orders + Verified Webhooks</div>
          </div>
        </div>

        <div class="muted recon-summary-note">
          Summary reflects currently loaded records.
        </div>
      </section>

      <!-- =====================================================
           üîπ PHASE 2 ‚Äî FILTERS + EXPORT (VIEW-ONLY)
           ===================================================== -->
      <section class="recon-controls">
        <div class="recon-filters">
          <span class="muted">Filters:</span>

          <select id="filter-status">
            <option value="">All Statuses</option>
            <option value="captured">Captured</option>
            <option value="failed">Failed</option>
            <option value="refunded">Refunded</option>
          </select>

          <select id="filter-currency">
            <option value="">All Currencies</option>
            <option value="INR">INR</option>
            <option value="USD">USD</option>
          </select>

          <input type="date" id="filter-from" />
          <input type="date" id="filter-to" />

          <span class="muted small">
            Filters affect display only. Source data unchanged.
          </span>
        </div>

        <div class="recon-exports">
          <button id="exportCsvBtn">‚¨áÔ∏è Export CSV</button>
          <button id="exportPdfBtn">‚¨áÔ∏è Export PDF</button>
        </div>
      </section>

      <div class="tabs">
        <button class="tab-btn active" data-tab="advisory">Advisory Insights</button>
        <button class="tab-btn" data-tab="programs">Programs</button>
      </div>

      <!-- =====================================================
           ADVISORY INSIGHTS
           ===================================================== -->
      <section id="tab-advisory" class="tab-panel active">
        <h2>Advisory Insights (Independent Product)</h2>

        <div class="muted small">
          Sorted by capture time (system default).
        </div>

        <table class="admin-table">
          <thead>
            <tr>
              <th>Order ID (Razorpay)</th>
              <th>Payment ID</th>
              <th>Email</th>
              <th>Artifact</th>
              <th>Amount (INR)</th>
              <th>Status</th>
              <th>Captured At</th>
            </tr>
          </thead>
          <tbody id="advisoryRows">
            <tr>
              <td colspan="7" class="muted">Loading‚Ä¶</td>
            </tr>
          </tbody>
        </table>
      </section>

      <!-- =====================================================
           PROGRAMS (UNCHANGED)
           ===================================================== -->
      <section id="tab-programs" class="tab-panel">
        <h2>Programs (Institutional)</h2>
        <p class="muted">
          Programs are governed through academic and administrative workflows.
          Payments are not reconciled here.
        </p>

        <ul>
          <li>Professional Track (P)</li>
          <li>Master Track (M)</li>
          <li>Leadership & Product Track (L)</li>
        </ul>
      </section>

    </main>
  </div>
</body>
</html>
