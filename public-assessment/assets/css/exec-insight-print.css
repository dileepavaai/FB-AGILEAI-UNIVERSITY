/* =====================================================
   Executive Insight Report
   SCREEN + PRINT â€” FINAL LOCKED CANONICAL VERSION
   -----------------------------------------------------
   PRINT GUARANTEES:
   - EXACT page count (1 exec-page = 1 page)
   - No phantom first / last pages
   - Header & footer perfectly aligned
   - Executive-grade PDF output
   ===================================================== */


/* =====================================================
   SCREEN MODE â€” WEB EXPERIENCE
   ===================================================== */
@media screen {

  body {
    background: #f3f3f3;
  }

  .exec-insight-document {
    max-width: 860px;
    margin: 40px auto;
  }

  .exec-page {
    background: #ffffff;
    margin: 0 0 48px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.08);
    border-radius: 2px;
  }

  .exec-page-header,
  .exec-page-footer {
    padding: 32px 40px;
  }

  .exec-page-content {
    padding: 40px;
  }

  /* Executive cover (screen only) */
  .exec-page:first-of-type .exec-cover-page {
    margin-top: 120px;
    text-align: center;
  }

  .exec-cover-title {
    font-size: 22px;
    font-weight: 600;
    letter-spacing: 0.4px;
    margin-bottom: 28px;
  }

  .exec-cover-meta {
    font-size: 14px;
    line-height: 1.9;
    margin-bottom: 26px;
  }

  .exec-cover-note {
    font-size: 12px;
    color: #555;
    line-height: 1.6;
  }
}


/* =====================================================
   PRINT MODE â€” HARD-LOCKED EXECUTIVE PDF
   ===================================================== */
@media print {

  /* ---------------------------------------------
     A4 definition (Chrome-safe)
     --------------------------------------------- */
  @page {
    size: A4;
    margin: 18mm;
  }

  /* ---------------------------------------------
     Remove all non-document UI
     --------------------------------------------- */
  #site-header,
  #site-footer,
  .exec-nav,
  #exec-pdf-actions,
  button {
    display: none !important;
  }

  html,
  body {
    margin: 0 !important;
    padding: 0 !important;
    background: #ffffff !important;
  }

  /* ---------------------------------------------
     Document wrapper
     --------------------------------------------- */
  .exec-insight-document {
    margin: 0 !important;
    padding: 0 !important;
    background: none !important;
  }

  /* ---------------------------------------------
     PDF metadata (appears once, no page split)
     --------------------------------------------- */
  .exec-pdf-meta {
    display: block !important;
    margin-bottom: 6mm !important;
    page-break-after: avoid !important;
    break-after: avoid !important;
  }

  /* ---------------------------------------------
     CORE RULE â€” ONE PAGE = ONE exec-page
     --------------------------------------------- */
  .exec-page {
    position: relative !important;
    height: calc(297mm - 36mm) !important;

    /* ðŸ”‘ Correct pagination model */
    page-break-after: always !important;
    break-after: page !important;

    page-break-inside: avoid !important;
    break-inside: avoid !important;

    margin: 0 !important;
    padding: 0 !important;
    box-shadow: none !important;
    background: none !important;
  }

  /* ðŸ”‘ FIRST PAGE â€” no forced break before */
  .exec-page:first-of-type {
    page-break-before: auto !important;
    break-before: auto !important;
  }

  /* ðŸ”‘ LAST PAGE â€” prevent phantom trailing page */
  .exec-page:last-of-type {
    page-break-after: auto !important;
    break-after: auto !important;
  }

  /* ---------------------------------------------
     HEADER â€” top locked
     --------------------------------------------- */
  .exec-page-header {
    position: absolute !important;
    top: 0;
    left: 0;
    right: 0;

    display: flex !important;
    justify-content: space-between !important;
    align-items: flex-end !important;

    padding: 8mm 0 4mm 0 !important;
    border-bottom: 1px solid #e5e5e5 !important;
  }

  /* ---------------------------------------------
     FOOTER â€” bottom locked
     --------------------------------------------- */
  .exec-page-footer {
    position: absolute !important;
    bottom: 0;
    left: 0;
    right: 0;

    display: flex !important;
    justify-content: space-between !important;
    align-items: flex-start !important;

    padding: 4mm 0 8mm 0 !important;
    border-top: 1px solid #e5e5e5 !important;

    font-size: 10px !important;
    color: #666 !important;
  }

  /* ---------------------------------------------
     CONTENT bounds
     --------------------------------------------- */
  .exec-page-content {
    position: absolute !important;
    top: 28mm;
    bottom: 28mm;
    left: 0;
    right: 0;

    padding: 0 !important;
  }

  /* ---------------------------------------------
     Executive cover (print only)
     --------------------------------------------- */
  .exec-page:first-of-type .exec-cover-page {
    position: absolute !important;
    top: 38% !important;
    left: 0;
    right: 0;
    text-align: center !important;
  }

  .exec-cover-title {
    font-size: 22px !important;
    font-weight: 600 !important;
    letter-spacing: 0.4px !important;
    margin-bottom: 28px !important;
  }

  .exec-cover-meta {
    font-size: 14px !important;
    line-height: 1.9 !important;
    margin-bottom: 26px !important;
  }

  .exec-cover-note {
    font-size: 12px !important;
    color: #555 !important;
    line-height: 1.6 !important;
  }

  /* ---------------------------------------------
     Typography stability
     --------------------------------------------- */
  h1, h2, h3 {
    font-weight: 600 !important;
  }

  p {
    margin-bottom: 14px !important;
    line-height: 1.45 !important;
    orphans: 3;
    widows: 3;
  }

  /* ---------------------------------------------
     Charts & SVG
     --------------------------------------------- */
  svg,
  img,
  .ei-chart-block,
  .ei-chart-frame {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
    max-width: 100% !important;
  }

  /* ---------------------------------------------
     Disable browser headers/footers
     --------------------------------------------- */
  header,
  footer {
    display: none !important;
  }

  * {
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }
}
